<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>콘서트 통합 정보</title>
    <!-- FullCalendar -->
    <link href='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.css' rel='stylesheet' integrity="sha384-a+uEN0SA9NPmaoLnc5WsmxDS2SgEiUlzTisgqmWvaOsxzPREhiatn8EIBuY/Zsl2" crossorigin="anonymous" />
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js' integrity="sha384-WfE/vOHqht3KDj6FvpwQUf3UxEPUHoGJ3w1yZ8rhpLWnVigt8HjXL2zXqtcfS7mf" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <button class="home-btn" onclick="goHome()" title="홈으로">🏠</button>
            <div class="lang-selector">
                <select id="langSelect" onchange="changeLanguage(this.value)">
                    <option value="ko">🇰🇷 한국어</option>
                    <option value="en">🇺🇸 English</option>
                    <option value="ja">🇯🇵 日本語</option>
                    <option value="zh">🇨🇳 中文</option>
                    <option value="es">🇪🇸 Español</option>
                </select>
            </div>
            <h1 data-i18n="title">공연 통합 정보</h1>
            <p data-i18n="subtitle">콘서트 · 뮤지컬 · 연극 · K-POP · 내한공연</p>
            <div class="update-info" id="updateInfo" data-i18n="lastUpdate">마지막 업데이트: -</div>
        </header>

        <div class="search-box">
            <h2 data-i18n="search">공연 검색</h2>
            <div class="search-form">
                <div class="form-group">
                    <label data-i18n="keyword">검색어</label>
                    <input type="text" id="keyword" data-i18n-placeholder="keywordPlaceholder" placeholder="아티스트, 공연명 입력...">
                </div>
                <div class="form-group">
                    <label data-i18n="startDate">시작일</label>
                    <input type="date" id="startDate">
                </div>
                <div class="form-group">
                    <label data-i18n="endDate">종료일</label>
                    <input type="date" id="endDate">
                </div>
                <button class="btn btn-primary" onclick="loadAllData()" data-i18n="searchBtn">검색</button>
            </div>
        </div>

        <!-- 뷰 전환: 목록 / 캘린더 -->
        <div class="view-tabs">
            <button class="view-tab active" onclick="switchView('list', this)" data-i18n="listView">📋 목록 보기</button>
            <button class="view-tab" onclick="switchView('calendar', this)" data-i18n="calendarView">📅 캘린더 보기</button>
        </div>

        <!-- 알림 바 -->
        <div class="noti-bar" id="notiBar">
            <div class="noti-bar-left">
                <span class="noti-bar-label">알림</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="notiToggle" onchange="toggleNotification(this.checked)">
                    <span class="toggle-slider"></span>
                </label>
                <span class="noti-bar-label" id="notiStatus" style="color: #666; font-size: 0.8rem;">비활성</span>
            </div>
            <div class="fav-count-badge" id="favCountBadge" onclick="toggleFavFilter()">
                ♥ 관심 <span id="favCount">0</span>건
            </div>
        </div>

        <!-- 목록 뷰 -->
        <div id="listView" class="list-view">
            <!-- 메인 파트 탭 -->
            <div class="part-tabs">
                <button class="part-tab active" onclick="switchPart('concert', this)" data-i18n="concert">🎤 콘서트</button>
                <button class="part-tab" onclick="switchPart('theater', this)" data-i18n="theater">🎭 연극 & 뮤지컬</button>
            </div>

            <!-- 소스 필터 탭 -->
            <div class="source-tabs">
                <button class="source-tab active" onclick="filterSource('all', this)" data-i18n="all">전체</button>
                <button class="source-tab" onclick="filterSource('KOPIS', this)" style="border-color: #00d4ff;">KOPIS</button>
                <button class="source-tab" onclick="filterSource('인터파크', this)" style="border-color: #ff6464;" data-i18n="interpark">인터파크</button>
                <button class="source-tab" onclick="filterSource('멜론티켓', this)" style="border-color: #00cd3c;" data-i18n="melon">멜론</button>
                <button class="source-tab" onclick="filterSource('YES24', this)" style="border-color: #ffc800;">YES24</button>
            </div>

            <!-- 지역 필터 탭 -->
            <div class="region-tabs" id="regionTabs">
                <button class="region-tab active" onclick="filterRegion('all', this)" data-i18n="all">전체</button>
                <button class="region-tab" onclick="filterRegion('서울', this)" data-i18n="seoul">서울</button>
                <button class="region-tab" onclick="filterRegion('경기·인천', this)" data-i18n="gyeonggi">경기·인천</button>
                <button class="region-tab" onclick="filterRegion('강원', this)" data-i18n="gangwon">강원</button>
                <button class="region-tab" onclick="filterRegion('충청', this)" data-i18n="chungcheong">충청</button>
                <button class="region-tab" onclick="filterRegion('전라', this)" data-i18n="jeolla">전라</button>
                <button class="region-tab" onclick="filterRegion('경상', this)" data-i18n="gyeongsang">경상</button>
                <button class="region-tab" onclick="filterRegion('제주', this)" data-i18n="jeju">제주</button>
                <button class="region-tab" onclick="filterRegion('미분류', this)" data-i18n="unclassified">미분류</button>
            </div>

            <!-- 콘서트 세부 장르 탭 (콘서트 파트에서만 표시) -->
            <div class="tabs" id="genreTabs">
                <button class="tab-btn active" onclick="showTab('all', this)">🔥 <span data-i18n="genreAll">전체</span></button>
                <button class="tab-btn" onclick="showTab('아이돌', this)">💜 <span data-i18n="genreIdol">아이돌/K-POP</span></button>
                <button class="tab-btn" onclick="showTab('발라드', this)">🎤 <span data-i18n="genreBallad">발라드</span></button>
                <button class="tab-btn" onclick="showTab('트로트', this)">📺 <span data-i18n="genreTrot">트로트</span></button>
                <button class="tab-btn" onclick="showTab('랩/힙합', this)">🎧 <span data-i18n="genreHiphop">랩/힙합</span></button>
                <button class="tab-btn" onclick="showTab('락/인디', this)">🎸 <span data-i18n="genreRock">락/인디</span></button>
                <button class="tab-btn" onclick="showTab('내한공연', this)">🌍 <span data-i18n="genreWorldtour">내한공연</span></button>
                <button class="tab-btn" onclick="showTab('팬미팅', this)">👥 <span data-i18n="genreFanmeeting">팬미팅</span></button>
                <button class="tab-btn" onclick="showTab('페스티벌', this)">🎪 <span data-i18n="genreFestival">페스티벌</span></button>
                <button class="tab-btn" onclick="showTab('기타', this)">📌 <span data-i18n="genreEtc">기타</span></button>
            </div>

        <div class="stats-bar" id="statsBar">
            <div class="stat-item">
                <div class="stat-number" id="totalCount">0</div>
                <div class="stat-label">전체</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="kopisCount">0</div>
                <div class="stat-label">KOPIS</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="interparkCount">0</div>
                <div class="stat-label">인터파크</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="melonCount">0</div>
                <div class="stat-label">멜론</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="yes24Count">0</div>
                <div class="stat-label">YES24</div>
            </div>
        </div>

            <div id="results">
                <div class="empty-state">
                    <h3>공연 정보를 불러오세요</h3>
                    <p>검색 버튼을 클릭하면 공연 정보를 조회합니다.</p>
                    <br>
                    <button class="btn btn-primary" onclick="loadAllData()">전체 공연 불러오기</button>
                </div>
            </div>
        </div><!-- /listView -->

        <!-- 캘린더 뷰 -->
        <div id="calendarView" class="calendar-container">
            <div class="calendar-tabs">
                <button class="calendar-tab active" onclick="switchCalendar('ticket', this)">🎫 예매오픈 캘린더</button>
                <button class="calendar-tab concert-tab" onclick="switchCalendar('concert', this)">🎤 공연일정 캘린더</button>
            </div>
            <div class="calendar-wrapper">
                <div id="calendar"></div>
            </div>
            <div style="margin-top: 15px; text-align: center; color: #888; font-size: 0.85rem;">
                <span style="display: inline-block; width: 12px; height: 12px; background: #ff6464; border-radius: 3px; margin-right: 5px;"></span> 예매오픈일
                <span style="margin-left: 20px; display: inline-block; width: 12px; height: 12px; background: #00cd3c; border-radius: 3px; margin-right: 5px;"></span> 공연일
            </div>
        </div>
    </div>

    <!-- 상세 팝업 모달 -->
    <div class="modal-overlay" id="modalOverlay" onclick="closeModal(event)">
        <div class="modal" onclick="event.stopPropagation()">
            <button class="modal-close" onclick="closeModal()">&times;</button>
            <div class="modal-poster" id="modalPoster">
                <span>No Image</span>
            </div>
            <div class="modal-content">
                <h2 class="modal-title" id="modalTitle">공연명</h2>
                <div class="modal-dday dday-normal" id="modalDday">D-day</div>
                <div class="modal-info">
                    <div class="modal-info-item">
                        <span class="modal-info-label" data-i18n="date">공연일</span>
                        <span class="modal-info-value" id="modalDate">-</span>
                    </div>
                    <div class="modal-info-item">
                        <span class="modal-info-label" data-i18n="venue">장소</span>
                        <span class="modal-info-value" id="modalVenue">-</span>
                    </div>
                    <div class="modal-info-item">
                        <span class="modal-info-label" data-i18n="genre">장르</span>
                        <span class="modal-info-value" id="modalGenre">-</span>
                    </div>
                    <div class="modal-info-item">
                        <span class="modal-info-label" data-i18n="ticketOpen">티켓오픈</span>
                        <span class="modal-info-value" id="modalTicketOpen">-</span>
                    </div>
                    <div class="modal-info-item">
                        <span class="modal-info-label" data-i18n="price">가격</span>
                        <span class="modal-info-value" id="modalPrice">-</span>
                    </div>
                    <div class="modal-info-item">
                        <span class="modal-info-label" data-i18n="cast">출연</span>
                        <span class="modal-info-value" id="modalCast">-</span>
                    </div>
                    <div class="modal-info-item">
                        <span class="modal-info-label" data-i18n="status">상태</span>
                        <span class="modal-info-value" id="modalState">-</span>
                    </div>
                </div>
                <div class="modal-links" id="modalLinks">
                    <!-- 예매 링크 버튼들 -->
                </div>
            </div>
        </div>
    </div>

    <footer>
        <p>공연 통합 정보 시스템 v3.3</p>
        <p style="margin-top: 10px; font-size: 0.85rem;">데이터 출처: KOPIS(공연예술통합전산망), 인터파크, 멜론티켓, YES24</p>
        <p style="margin-top: 5px; font-size: 0.8rem; color: #555;">콘서트 / 연극 & 뮤지컬 파트 분류 · 7개 권역 지역 필터 · 12시간 자동 업데이트 · 찜/알림</p>
    </footer>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
